---
title: "Examining the Influence of Premises Type and Time of Day on Violent Crime in Toronto"
subtitle: "A Bayesian Approach to Analyzing Contextual and Temporal Factors in Urban Crime Dynamics"
author: 
  - Tim Chen
thanks: "Code and data are available at: [https://github.com/timchen0326/crime-analysis-toronto](https://github.com/timchen0326/crime-analysis-toronto)."
date: today
date-format: long
abstract: "This paper analyzes the contextual and temporal factors influencing violent crimes in Toronto using data from the Major Crime Indicators dataset. A Bayesian logistic regression model explains that violent crimes are more likely to occur in transit and outdoor locations compared to residential and educational premises. Crimes are also more likely to be violent during afternoon and evening hours than early mornings. These findings support urban safety planning and targeted crime prevention strategies."
format: 
  pdf:
    number-sections: true
    toc: true
    toc-depth: 2
bibliography: references.bib
---


```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(arrow)
library(here)
library(rstanarm)
library(modelsummary)
library(ggplot2)
library(knitr)
library(marginaleffects)
library(plotly)
library(tibble)
library(margins)
library(kableExtra)
library(patchwork)
```


# Introduction

## Overview

This study examines the factors influencing the likelihood of violent crimes in Toronto, focusing on two important predictors: the type of premises where the crime occurred and the time of day. Violent crime, encompassing offenses such as assault and robbery, poses significant risks to community safety and requires evidence-based strategies for prevention. Non-violent crimes, such as theft and property-related offenses, provide a contrasting baseline for analysis.

Using a detailed dataset. from the Toronto Police Service, this research aims to uncover patterns and relationships between the environment, timing, and the probability of violent crimes. By leveraging Bayesian logistic regression modeling, the study accounts for uncertainty while using prior knowledge to generate practical findings. The findings aim to inform crime prevention efforts, resource allocation, and urban safety policies by identifying high-risk contexts for violence.


## Estimand
The primary estimand of this study is the probability of a violent crime occurring given specific premises (e.g., residential, commercial, or transit) and the time of day (e.g., early morning, evening). Violent crimes include serious offenses such as assaults and robberies, while non-violent crimes encompass thefts and similar offenses. This research employs a Bayesian logistic regression model to estimate these probabilities, accounting for uncertainty and using prior knowledge.

## Results Summary

The results of this study provide clarity on the relationship between premises type, time of day, and the likelihood of a crime being violent. Premises such as "Transit" and "Outside" exhibit greater odds of violent crimes compared to the reference category ("Apartment"), reflecting their open and public nature, which may increase opportunities for conflicts. Conversely, premises like "Commercial," "Educational," and "House" are associated with a lower likelihood of violent crimes, underscoring the role of structural and social controls in reducing violence.

Time of day also plays a significant role, with "Afternoon" and "Evening" periods showing elevated odds of violent crimes compared to the baseline "Early Morning." These findings align with patterns of increased social interactions and activities during these periods. The credible interval plots further confirm the statistical significance of these predictors, emphasizing their impact on crime likelihood. Overall, the results highlight patterns that can guide focused crime prevention strategies in high-risk locations and time periods.


## Why This Study Matters

Understanding the contextual factors contributing to violent crimes can help city planners and policymakers allocate safety interventions effectively. This research focuses on premises and times of day where the likelihood of violence is highest, enabling tailored prevention strategies. The findings from this study can directly impact resource allocation for policing and urban planning, potentially reducing crime rates and enhancing public safety.

## Paper Structure

The remainder of this paper is structured as follows. In @sec-data, we present an overview of the dataset used in this study, along with a detailed description of the variables and the data cleaning process. @sec-model outlines the Bayesian logistic regression model applied in our analysis, including the model setup, assumptions, and justification. In @sec-result, we summarize the results of our analysis and interpret the findings within the context of existing literature on road safety. Finally, @sec-discussion discusses the implications of these findings, acknowledges the limitations of the study, and suggests directions for future research.

# Data {#sec-data}

## Overview

We use the statistical programming language R [@citeR] to process, clean, and analyze the dataset for this study. Key R packages employed include `tidyverse` for data manipulation and visualization [@thereferencecanbewhatever], `arrow` for efficient data storage and retrieval [@arrowR], `here` for managing file paths [@here], `rstanarm` for Bayesian modeling [@rstanarm], `kableExtra` for enhanced table formatting [@kableExtra], `janitor` for cleaning messy data [@janitor], `lubridate` for working with dates and times [@lubridate], `marginaleffects` for calculating marginal effects [@marginaleffects], `plumber` for creating REST APIs [@plumber], `testthat` for unit testing [@testthat], and `opendatatoronto` for accessing Toronto’s open data [@opendatatoronto].

Our data is sourced from the Open Data Toronto portal [@OpenDataToronto], specifically from the "Motor Vehicle Collisions Involving Killed or Seriously Injured Persons" dataset, which captures detailed information on traffic incidents in Toronto where individuals were either killed or seriously injured. This dataset, compiled by the Toronto Police Service, includes variables that record the time, location, environmental conditions, and specific parties involved in each collision, showing factors that may increase the risk of severe outcomes.

The detailed information within the dataset enables a rigorous analysis of patterns in collision severity. By examining factors such as driver condition, road surface, and lighting conditions, we aim to identify high-risk scenarios that may require targeted safety interventions. Following principles outlined in "Telling Stories with Data" [@tellingstories], this study prioritizes transparency and reproducibility in presenting findings that can inform road safety policies.


## Measurement

The dataset used in this study is sourced from the Toronto Police Service and includes records of Major Crime Indicators (MCI) occurrences. These records capture information on five important categories of crime: Assault, Break and Enter, Auto Theft, Robbery, and Theft Over. Unlike some crime datasets, this dataset excludes occurrences classified as "unfounded," meaning that only verified incidents are included. The definition of "unfounded," provided by Statistics Canada, is: “It has been determined through police investigation that the offence reported did not occur, nor was it attempted.”

To align with the study’s focus on temporal and environmental factors influencing violent crime, we selected crimes reported during the month of July. This decision was informed by research highlighting July as a high-risk period for violent crimes due to its status as one of the warmest months globally and its alignment with peak social activity [@JulyTemperatureRecords; @SeasonalityOfCrime]. Higher temperatures during July have been linked to increased aggression and lowered inhibition, a phenomenon described by the "Temperature/Aggression" theory [@SeasonalityOfCrime]. Moreover, the Routine Activities theory explains that greater public activity in July provides more opportunities for interaction between offenders and victims, potentially elevating crime rates [@SeasonalityOfCrime].

The data collection process primarily relies on police-reported incidents. However, there are certain limitations in the completeness of the dataset. For example, some location coordinates are missing or left blank when the location could not be verified. Additionally, the dataset includes occurrences that are located outside the City of Toronto, which may slightly affect the analysis for Toronto-specific crime trends. 

Spatial data in the dataset is provided using both the old 140-neighborhood structure and the newer 158-neighborhood structure for the City of Toronto. This dual structure ensures compatibility across different time periods and administrative updates. Temporal data includes detailed timestamps that allow crimes to be categorized by time of day and season.

The unit of measurement for numerical data, such as timestamps and neighborhood IDs, is standard counts or identifiers with no inherent units. Other features, such as crime type, premises type, and time of day, are categorical variables with no associated units.

Although the data provides a robust framework for understanding crime patterns in Toronto, some aspects are modeled or incomplete. For instance, location data for certain crimes may be estimated, and the dataset does not include crimes that were not reported to the police. Despite these limitations, the dataset remains a useful resource for analyzing environmental and temporal factors influencing violent and non-violent crimes in Toronto.


## Data Cleaning

The raw crime data underwent a cleaning process to prepare it for analysis, ensuring the dataset was both relevant and consistent for the study's objectives. Initially, only key columns were selected from the raw dataset, including `EVENT_UNIQUE_ID` (Unique Identifier), `REPORT_DATE` (Date of Report), `OCC_HOUR` (Hour of Occurrence), `PREMISES_TYPE` (Type of Premises), and `OFFENCE` (Offense Type). This selection ensured that only the most pertinent information was included for examining factors associated with violent crimes.

Rows with missing or irrelevant data in important columns, such as `EVENT_UNIQUE_ID`, `PREMISES_TYPE`, `TIME_OF_DAY`, and `VIOLENT_CRIME`, were removed to maintain data integrity and focus on valid observations. Offenses were categorized as either violent or non-violent to create a binary outcome variable (`VIOLENT_CRIME`), where offenses such as "Assault" and "Robbery" were classified as violent (`1`), and crimes like "Theft" or "Break and Enter" were classified as non-violent (`0`). Offenses that did not fit into either category were excluded from the dataset.

To analyze temporal patterns, the `OCC_HOUR` variable was grouped into broader time categories:

- **Early Morning**: 12 AM to 6 AM  
- **Morning**: 6 AM to 12 PM  
- **Afternoon**: 12 PM to 6 PM  
- **Evening**: 6 PM to 12 AM  

Additionally, the `PREMISES_TYPE` variable, which describes the type of location where the incident occurred, was trimmed to remove excess whitespace and ensure consistent formatting. This step was to prevent unexpected NA values during analysis.

The cleaning process also included filtering for crimes reported during the summer month of July, aligning the dataset with the study's focus on temporal and environmental patterns in criminal activity. After grouping, formatting, and filtering the data, all rows containing NA values in important columns were dropped to ensure a clean and analyzable dataset.

Finally, the cleaned dataset was saved as a Parquet file for further analysis. This format ensures efficient storage and retrieval while preserving the structure of the data.



## Outcome variable

The primary outcome variable in this study is Violent Crime, which categorizes each incident based on whether the crime is classified as violent or non-violent. Violent crime is coded as a binary variable, where "0" represents non-violent offenses (e.g., theft, break and enter), and "1" denotes violent offenses (e.g., assault, robbery). This classification allows for an assessment of factors contributing to the likelihood of a crime being violent, providing a framework for understanding the underlying conditions associated with violent behavior.

By focusing on crimes involving violence, this outcome variable highlights important cases of interest for public safety and crime prevention efforts, as violent offenses often have severe consequences for victims and communities. This binary categorization simplifies the statistical analysis, enabling the application of logistic regression models to estimate the probability of violent crimes under varying conditions.

Analyzing violent crime in conjunction with predictor variables such as premises type and time of day helps identify the circumstances under which the risk of violence is heightened. This outcome measure serves as a indicator for assessing and improving community safety policies, as it reflects the most serious consequences of criminal activity and directs attention to factors that could reduce violent incidents.


```{r}
#| include: false
#| warning: false
#| message: false

#### Read in cleaned data ####
crime_data <- read_parquet(here::here("data/02-analysis_data/cleaned_crime_data_for_model.parquet"))

#### Set up factors and select relevant columns ####
crime_data <- 
  crime_data |>
  mutate(
    # Convert outcome variable to factor
    VIOLENT_CRIME = as_factor(VIOLENT_CRIME),
    # Ensure predictors are set as factors with meaningful levels
    PREMISES_TYPE = factor(
      PREMISES_TYPE,
      levels = c(
        "Apartment",  # Example level
        "House",   # Example level
        "Commercial",       # Example level
        "Outside",
        "Educational",
        "Transit",
        "Other"        # Ensure levels match your data
      )
    ),
    TIME_OF_DAY = factor(
      TIME_OF_DAY,
      levels = c(
        "Early Morning",
        "Morning",
        "Afternoon",
        "Evening"
      )
    )
  ) |>
  # Select relevant columns for modeling
  select(VIOLENT_CRIME, PREMISES_TYPE, TIME_OF_DAY)

```

```{r}
#| label: tbl-clean-data
#| tbl-cap: "Preview of the cleaned Crime dataset"
#| message: false
#| echo: false

# Rename columns for display purposes
colnames(crime_data) <- c("Violent Crime", "Premises Type", "Time of Day")

# Display the first 5 rows of the selected columns
crime_data[1:5, 1:3] |>
  kable()

```

## Predictor variables

@fig-premises-type illustrates the distribution of violent versus non-violent crimes across different premises types. The results show that the highest number of crimes, both violent and non-violent, occur in "Outside" locations, followed by "Apartment" premises. Notably, violent crimes significantly outnumber non-violent ones in "Outside" locations, while "Apartments" and "Houses" have a more balanced distribution between the two crime types. Premises categorized as "Educational," "Transit," and "Other" show relatively low numbers of both violent and non-violent crimes, with "Educational" premises having the fewest incidents overall.

@fig-time-of-day highlights the distribution of violent versus non-violent crimes by the time of day. The data explains that violent crimes are most common during the "Evening," followed by "Afternoon" and "Early Morning." In contrast, non-violent crimes are more evenly distributed throughout the day but still peak during the "Evening." These findings suggest that the time of day plays a important role in influencing the likelihood of violent crimes, with evenings being a particularly high-risk period.

By examining these distributions, we gain intuitions into where and when violent crimes are most likely to occur. Understanding these patterns is essential for developing focused crime prevention strategies, such as increasing law enforcement presence in high-risk areas during evening hours or implementing community-based interventions in "Outside" locations.


```{r}
#| label: fig-premises-type
#| fig-cap: The distribution of violent vs. non-violent crimes by premises type
#| echo: false
#| warning: false
#| message: false

# Rename columns for clarity in the plot
colnames(crime_data) <- c("violent_crime", "premises_type", "time_of_day")

# Recode the violent_crime variable for better legend labels
crime_data <- crime_data %>%
  mutate(
    violent_crime = recode(
      violent_crime,
      `0` = "Non-Violent",
      `1` = "Violent"
    )
  )

# Plot: Distribution of Violent vs. Non-Violent Crimes by Premises Type
crime_data |>
  ggplot(aes(x = premises_type, fill = violent_crime)) +
  geom_bar(position = "dodge", width = 0.5) +
  theme_minimal() +
  coord_flip() +
  scale_fill_brewer(palette = "Set1") +
  labs(
    x = "Premises Type",
    y = "Number of Crimes",
    fill = "Crime Type"
  )


```

```{r}
#| label: fig-time-of-day
#| fig-cap: The distribution of violent vs. non-violent crimes by time of day
#| echo: false
#| warning: false
#| message: false

# Recode the violent_crime variable for better legend labels
crime_data <- crime_data %>%
  mutate(
    violent_crime = recode(
      violent_crime,
      `0` = "Non-Violent",
      `1` = "Violent"
    )
  )

# Plot: Distribution of Violent vs. Non-Violent Crimes by Time of Day
crime_data |>
  ggplot(aes(x = time_of_day, fill = violent_crime)) +
  geom_bar(position = position_dodge2(width = 0.5, preserve = "single")) +
  coord_flip() +
  theme_minimal() +
  scale_fill_brewer(palette = "Set1") +
  labs(
    x = "Time of Day",
    y = "Number of Crimes",
    fill = "Crime Type"
  )


```



# Model {#sec-model}

In our analysis, we utilized a Bayesian logistic regression model to examine the relationship between violent crime occurrence and two important predictors: premises type and time of day. By using this model, we aimed to understand how the location and timing of incidents influence the likelihood of a crime being classified as violent. Detailed model diagnostics and background are provided in [Appendix -@sec-model-details].

## Model Set-up

\begin{align} 
y_i|\pi_i &\sim \text{Bern}(\pi_i) \\
\text{logit}(\pi_i) &= \alpha + \beta_1 \times \text{PREMISES\_TYPE}_i + \beta_2 \times \text{TIME\_OF\_DAY}_i \\
\alpha &\sim \text{Normal}(0, 2.5) \\
\beta_1 &\sim \text{Normal}(0, 2.5) \\
\beta_2 &\sim \text{Normal}(0, 2.5)
\end{align}

In this model:

- $\beta_1$ is the coefficient corresponding to the type of premises (\texttt{PREMISES\_TYPE}$_i$) where the crime occurred.

- $\beta_2$ is the coefficient corresponding to the time of day (\texttt{TIME\_OF\_DAY}$_i$) when the crime occurred.



The logistic link function ($\text{logit}(\pi_i)$) models the log-odds of violent crime as a linear combination of the predictors. The priors for the intercept ($\alpha$) and the coefficients ($\beta_1$, $\beta_2$) follow a Normal distribution with mean $0$ and standard deviation $2.5$. These priors regularize the model, constraining the parameters to plausible values based on prior knowledge.

This Bayesian logistic regression model was implemented using the `rstanarm` package, leveraging Markov Chain Monte Carlo (MCMC) sampling for parameter estimation. Further diagnostics and posterior summaries are discussed in the supplementary materials (see Appendix @sec-model-details).


## Model Justification

Each predictor in the model represents a specific characteristic of the crime and its context, with hypothesized effects on the likelihood of violent crime. For `PREMISES_TYPE`, it is expected that certain locations, such as "Transit" or "Outside," may have higher odds of violent crime due to increased public interactions or a lack of controlled environments. Conversely, premises like "Educational" or "House" are anticipated to have lower odds of violent crime, reflecting their relatively private or structured settings. Locations categorized as "Other" may include mixed contexts, resulting in varying effects.

For `TIME_OF_DAY`, it is hypothesized that the "Evening" period may exhibit a higher likelihood of violent crimes, as this time is often associated with increased social activities and potential for interpersonal conflict. "Early Morning" may also show elevated odds due to decreased public surveillance and fewer witnesses. In contrast, "Morning" and "Afternoon" are expected to have lower odds, reflecting typical daytime routines with higher levels of oversight and structured activity.

These predictors, incorporated into a Bayesian logistic regression model, highlight relationships between crime characteristics and violent outcomes.


```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: tbl-modelresults
#| tbl-cap: "Explanatory model Injury Severity Prediction (n = 1000)"

violent_crime_model <-
  readRDS(file = here::here("models/violent_crime_model.rds"))

modelsummary(
  list(
    "Violent Crime" = violent_crime_model
  ),
  statistic = "mad"
  )

```

# Results {#sec-result}

Our results are summarized in @tbl-modelresults. The findings align with our expectations, providing intuitions into how premises type and time of day influence the likelihood of violent crimes. To avoid multicollinearity, the model excludes one level from each categorical predictor as the reference group: "Apartment" for `PREMISES_TYPE` and "Early Morning" for `TIME_OF_DAY`. The intercept represents the estimated log-odds of violent crime occurring when all other predictors are held constant at their reference levels. In this case, the estimated log-odds of a violent crime occurring at an "Apartment" during "Early Morning" is 0.881.

The type of premises strongly influences the likelihood of violent crimes. For instance, crimes occurring in "Transit" premises are far more likely to be violent compared to the reference group. The estimated coefficient for `PREMISES_TYPETransit` is 2.363, indicating a substantial increase in the log-odds of violent crime in this context. On the other hand, crimes occurring in "Commercial" and "Educational" premises are less likely to be violent, with coefficients of -0.925 and -0.957, respectively. Similarly, crimes at "House" premises exhibit the lowest likelihood of violence, as reflected by a coefficient of -1.519. These results highlight that location plays a important role in determining whether a crime is violent or non-violent.

Time of day also significantly impacts the likelihood of violent crimes. Compared to the reference level of "Early Morning," the coefficients for `TIME_OF_DAYAfternoon` and `TIME_OF_DAYEvening` are 0.413 and 0.325, respectively, suggesting an elevated likelihood of violent crimes during these times. The "Morning" time of day exhibits a negligible increase in violent crime likelihood, as shown by a coefficient of 0.074.

Figure 7 (see Section B.3) shows the range of coefficient estimates for our model within the 90% probability interval. However, because the credibility intervals for several predictors are relatively narrow, particularly for premises types like "Transit," it is challenging to observe the trends clearly. To address this, Figure 8 was created with the x-axis limited to a range of -5 to 5. Combining Figures 7 and 8, we observe statistical significance for several predictors, including "Transit," "Afternoon," and "Evening," as their credibility intervals do not cross zero.

The coefficients are reported in log-odds, where a positive value indicates an increased likelihood of violent crime, and a negative value reflects a decreased likelihood. The results demonstrate clear statistical significance for important predictors such as "Transit," "Afternoon," and "Evening," emphasizing the importance of both location and time of day in shaping violent crime outcomes.


# Discussion {#sec-discussion}

## Relationship between Premises Type and Violent Crime

The analysis underscores that premises type significantly influences the likelihood of violent crimes. Transit locations, often hubs of activity with limited surveillance, exhibit the highest odds of violent crimes. This aligns with urban safety theories suggesting that environments characterized by anonymity and low surveillance facilitate opportunistic and interpersonal violence. Similarly, outdoor areas, with their open and unregulated nature, remain high-risk zones for confrontations. In contrast, locations with inherent structural or social control, such as residential houses and schools, show markedly reduced odds of violent crimes. These findings emphasize the interplay between spatial control and crime likelihood, suggesting that environments fostering visibility, routine, and structural oversight are critical deterrents for violent activity. Policymakers might explore how urban designs, such as transit hubs with natural surveillance features, could mitigate risks in identified high-crime premises.

## Relationship between Time of Day and Violent Crime

Time of day has emerged as another critical determinant of violent crime patterns, reflecting the temporal rhythms of human activity. The elevated risk of violent crimes during afternoon and evening hours correlates with periods of heightened social interaction and mobility. Beyond the opportunity framework, this trend could also be linked to psychological and behavioral factors, such as stress accumulation or alcohol consumption patterns, which intensify during these hours. Morning hours, often structured by routines and higher institutional oversight, exhibit a stabilizing effect, further reinforcing the connection between predictability in human activity and crime reduction. These findings suggest that temporal interventions, such as staggered policing schedules or temporal zoning laws, could play a key role in mitigating violence during high-risk periods.

## Expanding Implications for Policy and Prevention

### Integrative Safety Planning

Building upon the findings, integrating urban design with crime prevention could yield significant dividends. For instance, redesigning transit hubs with open sightlines and enhanced illumination may disrupt anonymity and reduce violent crime opportunities. Similarly, encouraging the adoption of Crime Prevention Through Environmental Design (CPTED) principles in outdoor public spaces could transform potential high-crime locations into safer environments. Measures like pedestrian-oriented lighting, community-centric activities in outdoor spaces, and visible security features would align with these findings to promote safer urban environments.

### Socioeconomic Dimensions of Intervention

While the current study primarily addresses spatial and temporal patterns, incorporating socioeconomic factors into crime prevention strategies could provide a more holistic framework. For instance, transit areas may not only be risky due to environmental factors but also because they serve as nexus points for marginalized populations. Acknowledging these dynamics, policymakers could complement structural safety measures with socioeconomic upliftment programs, such as housing initiatives near transit hubs or employment opportunities targeting vulnerable demographics.

### Strategic Resource Allocation

The predictive insights offered by this study support law enforcement agencies in adopting data-driven approaches for resource allocation. By utilizing the RESTful API developed from this study, stakeholders can simulate various scenarios to predict high-risk situations and proactively deploy resources to mitigate risks. Expanding the API’s capabilities to integrate real-time data inputs, such as weather or crowd density, could further enhance its utility for dynamic and responsive safety planning.

## Limitations {#sec-limitations}

### Data Constraints

The study uses police-reported crime data, which excludes unreported incidents. This limitation is particularly important in areas where trust in law enforcement may be lower, potentially leading to underreporting. As a result, the analysis might underestimate the prevalence of violent crime or inaccurately represent its distribution. Future research could address this by incorporating additional data sources, such as hospital records or victim surveys, to provide a more complete picture.

### Simplification of Time Categories

Dividing time into four broad categories (Early Morning, Morning, Afternoon, and Evening) offers clarity but limits the ability to observe finer patterns. For example, crimes occurring during transitional periods, such as early evening or late night, might follow distinct trends not captured by this framework. Future studies could use more detailed time intervals to better align with changes in social activity and behavior.

### Contextual Variability

Factors such as seasonal events, public holidays, or local enforcement policies may affect crime patterns but were not included in this study. While July was chosen as a representative high-activity month, these findings may not extend to other times of the year. Future work could consider these contextual elements to enhance the understanding of violent crime dynamics.

## Expanding Future Directions

### Spatial Granularity

Future studies could use GIS technology to conduct detailed spatial analyses, identifying crime hotspots within larger categories like transit or outdoor spaces. Such an approach could guide precise interventions at the neighborhood or block level, helping to optimize prevention efforts and resource allocation.

### Temporal and Behavioral Factors

Exploring time with finer granularity, such as hourly trends, could reveal patterns that are currently obscured. Additionally, combining behavioral data—such as crowd size or environmental conditions—with existing predictors may uncover new insights, such as the combined impact of transit activity and evening hours on crime risk.

## Conclusion

This study identifies the significant roles that premises type and time of day play in shaping the likelihood of violent crimes in Toronto. High-risk locations, such as transit hubs and outdoor spaces, and peak times, such as afternoons and evenings, highlight areas for focused interventions. These findings can inform practical safety measures, such as improved surveillance and better resource allocation during critical times and in high-risk areas. Although the analysis is limited by its broad categories, it demonstrates the value of understanding crime patterns through spatial and temporal dimensions, laying the groundwork for future research and actionable safety strategies.




\newpage

\appendix

# Appendix: Survey Design to Investigate Factors Influencing Violent Crimes in Toronto

## Introduction

This survey is designed to gather detailed information from victims of violent crimes in Toronto during the month of July. The primary goal is to supplement existing police data to better understand the factors influencing the likelihood of violent crimes, with a focus on premises type and time of day. By collecting firsthand accounts from victims, the study aims to uncover additional insights that can inform effective crime prevention strategies and policies.

## Objectives

### Primary Objective

To identify and analyze factors contributing to the occurrence of violent crimes in Toronto by gathering detailed victim accounts.

### Secondary Objectives

- Explore the relationship between victim characteristics and the likelihood of experiencing violent crime.
- Assess environmental and situational factors not captured in police reports.
- Evaluate victims' perceptions and experiences to inform supportive services.

## Methodology

### Study Design

A cross-sectional survey will be conducted using a structured questionnaire administered to victims of violent crimes.

### Target Population

- Individuals aged 18 and above who were victims of reported violent crimes in Toronto during the month of July.

### Sampling Frame

Victims listed in the Toronto Police Service records for violent crimes occurring in July.

### Sampling Method

- **Census Approach**: Attempt to include all eligible victims.
- **If Not Feasible**: Employ stratified random sampling based on crime type and location to ensure representativeness.

### Inclusion Criteria

- Victims of violent crimes (e.g., assault, robbery) reported in July.
- Aged 18 years or older.
- Able to provide informed consent.

### Exclusion Criteria

- Victims under the age of 18.
- Incidents classified as unfounded or withdrawn.
- Individuals unable or unwilling to consent.

## Survey Instrument

This questionnaire is designed to collect detailed information from victims of violent crimes. The sections and questions align precisely with the Google Form provided. Additionally, attention checks have been included in the survey to ensure data quality. The survey is accessible at the following link:  
[https://forms.gle/d81J3S9HpPgJPUkM6](https://forms.gle/d81J3S9HpPgJPUkM6)

### Section 1: Demographics

1. **What is your age?**  
   *Required*  

2. **What is your gender?**  
   *Required*  
   - Male  
   - Female  
   - Non-binary  
   - Prefer not to say  

3. **What is your ethnicity?**  
   *Required*  

4. **What is your highest level of education completed?**  
   *Required*  

5. **What is your current occupation?**  
   *Required*  

### Section 2: Incident Details

6. **On what date did the incident occur?**  
   *Required (e.g., January 7, 2019)*  

7. **At what time did the incident occur?**  
   *Required*  

8. **Where did the incident occur?**  
   *Required*  

9. **What type of premises was it?**  
   *Required*  
   - Apartment  
   - House  
   - Commercial  
   - Outside  
   - Transit  
   - Educational  
   - Other: [Open-ended response]  

10. **What were you doing just before the incident?**  
    *Required*  

11. **Were you familiar with this area?**  
    *Required*  
    - Yes  
    - No  

12. **Select the option that does NOT belong in this list of fruits:**  
    - Apple  
    - Banana  
    - Carrot  
    - Orange  

### Section 3: Circumstances of the Incident

13. **Was the perpetrator known to you?**  
    *Required*  
    - Yes  
    - No  

14. **How many perpetrators were involved?**  
    *Required*  

15. **Can you describe the perpetrator(s)?**  
    *Required*  

16. **Were any weapons used?**  
    *Required*  
    - Yes  
    - No  
    - If Yes: *Please specify the type of weapon*  

17. **Do you know or suspect the motive behind the crime?**  
    *Required*  

### Section 4: Perceptions and Feelings

18. **Prior to the incident, how safe did you feel in that area?**  
    *Required (Likert scale: Not Safe at All to Very Safe)*  

19. **Were you aware of any risks or previous incidents in the area?**  
    *Required*  
    - Yes  
    - No  

20. **How did you feel during the incident?**  
    *Required*  

21. **How have you felt since the incident?**  
    *Required*  

### Section 5: Reporting and Response

22. **How was the incident reported?**  
    *Required*  
    - Self-reported  
    - Witness reported  
    - Other: [Open-ended response]  

23. **Approximately how long did it take for authorities to respond?**  
    *Required*  

24. **How satisfied are you with the response from authorities?**  
    *Required (Likert scale: Not Satisfied at All to Very Satisfied)*  

25. **Have you received any support services since the incident?**  
    *Required*  
    - Yes  
    - No  
    - If Yes: *Please specify*

26. **Which of these options has an even number of letters?**  
    - Apple  
    - Banana  
    - Orange  
    - Kiwi  

### Section 6: Additional Factors

27. **Had you consumed alcohol or drugs prior to the incident?**  
    *Required*  
    - Yes  
    - No  

28. **Do you believe the perpetrator(s) had consumed alcohol or drugs?**  
    *Required*  
    - Yes  
    - No  
    - Don't know  

29. **What were the lighting conditions at the time?**  
    *Required*  
    - Well-lit  
    - Dimly lit  
    - Dark  

30. **What was the weather like at the time?**  
    *Required*  
    - Clear  
    - Rainy  
    - Snowy  
    - Other: [Open-ended response]  

31. **Were there any security measures present?**  
    *Required*  
    - Cameras  
    - Security personnel  
    - None  
    - Other: [Open-ended response]  

32. **Were there other people around at the time?**  
    *Required*  
    - Yes  
    - No  
    - If Yes: *Approximately how many?*  


## Ethical Considerations

### Informed Consent

- Participants will receive detailed information about the study's purpose, procedures, risks, and benefits.
- Consent forms will be signed prior to participation.
- Participants can withdraw at any time without penalty.

### Confidentiality

- Personal identifiers will be removed or coded.
- Data will be stored securely with access limited to authorized personnel.
- Results will be reported in aggregate to prevent identification.

### Protection of Participants

- Interviews will be conducted sensitively to minimize distress.
- Referral information for support services will be provided.
- Participation is entirely voluntary.

### Ethical Approval

The study protocol will be reviewed and approved by an Institutional Review Board (IRB) or Research Ethics Board (REB) prior to commencement.

## Data Collection Procedures

### Mode of Data Collection

- **Primary Method**: Telephone interviews conducted by trained researchers.
- **Alternative Methods**: In-person interviews or online questionnaires, depending on participant preference.

### Interviewer Training

- Training on trauma-informed interviewing techniques.
- Guidelines on handling disclosures and providing support information.

### Timeline

Data collection will occur within two months following the incidents to ensure accurate recall.

### Contact Protocol

- Initial contact will be made via mail or email explaining the study and requesting participation.
- Follow-up contact will be made to schedule interviews.

## Data Management and Analysis

### Data Entry and Storage

- Data will be entered into a secure, password-protected database.
- Regular backups will be performed.
- Data will be encrypted to protect confidentiality.

### Data Cleaning

- Verification of data entry accuracy.
- Handling of missing data according to predefined protocols.

### Data Simulation

To validate and explore the survey design, a simulated dataset was generated to reflect the variables of interest. This dataset includes:

- **VIOLENT_CRIME**: Binary variable indicating whether a crime was violent (1) or non-violent (0).
- **ALCOHOL_INVOLVED**: Binary variable indicating whether alcohol was involved in the incident (1 = Yes, 0 = No).
- **AREA_FAMILIARITY**: Binary variable indicating whether the victim was familiar with the area (1 = Yes, 0 = No).
- **LIGHTING_CONDITIONS**: Categorical variable describing the lighting conditions at the time of the incident ('Well-lit', 'Dimly lit', 'Dark').

The dataset was generated using R, saved as a CSV file, and subsequently visualized to ensure the data reflects the survey's design specifications.

```{r}
#| label: fig-simulated-crime
#| fig-cap: "Visualizations of Simulated Crime Data Variables"
#| fig-subcap: ["Proportion of Violent Crimes", "Lighting Conditions Distribution", "Alcohol Involvement", "Area Familiarity"]
#| echo: false
#| warning: false
#| message: false

# Import the simulated data from the specified CSV file
simulated_data <- read_csv(here::here("data/00-simulated_data/survey_simulated_crime_data.csv"))

# Visualization: Proportion of Violent Crimes
violent_crime_plot <- simulated_data %>%
  ggplot(aes(x = factor(VIOLENT_CRIME))) +
  geom_bar(fill = "steelblue") +
  labs(
    x = "Violent Crime (0 = No, 1 = Yes)",
    y = "Count",
    title = "Distribution of Violent Crimes"
  ) +
  theme_minimal()

# Visualization: Lighting Conditions
lighting_conditions_plot <- simulated_data %>%
  ggplot(aes(x = LIGHTING_CONDITIONS)) +
  geom_bar(fill = "skyblue") +
  labs(
    x = "Lighting Conditions",
    y = "Count",
    title = "Lighting Conditions at Incident Time"
  ) +
  theme_minimal()

# Visualization: Proportion of Alcohol Involvement
alcohol_involvement_plot <- simulated_data %>%
  ggplot(aes(x = factor(ALCOHOL_INVOLVED))) +
  geom_bar(fill = "tomato") +
  labs(
    x = "Alcohol Involved (0 = No, 1 = Yes)",
    y = "Count",
    title = "Alcohol Involvement in Incidents"
  ) +
  theme_minimal()

# Visualization: Area Familiarity
area_familiarity_plot <- simulated_data %>%
  ggplot(aes(x = factor(AREA_FAMILIARITY))) +
  geom_bar(fill = "purple") +
  labs(
    x = "Area Familiarity (0 = No, 1 = Yes)",
    y = "Count",
    title = "Familiarity with Area"
  ) +
  theme_minimal()

# Combine all plots into a 2x2 layout
(violent_crime_plot | lighting_conditions_plot) /
(alcohol_involvement_plot | area_familiarity_plot)
```


## Quality Assurance

### Pilot Testing

- The survey will be pilot tested with a small group to identify issues with question clarity or sensitivity.
- Revisions will be made based on feedback.

### Data Monitoring

- Regular checks for data completeness and consistency.
- Interim analyses to identify any emerging issues.

## Dissemination of Results

- Findings will be compiled into a report.
- Academic papers will be prepared for publication in peer-reviewed journals.
- Results will be shared with the Toronto Police Service, policymakers, and community organizations.
- Presentations will be made at relevant conferences and meetings.


## Conclusion

This survey aims to enhance understanding of violent crimes in Toronto by incorporating victim perspectives and experiences. The data collected will contribute to more effective prevention strategies and support services, ultimately aiming to reduce the incidence of violent crimes and improve community safety.

\newpage


# Model details {#sec-model-details}

## Posterior Predictive Check and Prior-Posterior Comparison

The posterior predictive check in @fig-post_dist provides an evaluation of how well the Bayesian logistic regression model replicates the observed data. The posterior distribution ($y_{\text{rep}}$) closely aligns with the observed data ($y$), indicating that the model provides a good fit and captures the essential patterns in the data.

In @fig-post_prior, the posterior distributions of the model parameters are compared against their priors. This visual comparison highlights how the observed data influenced the posterior estimates. For instance, predictors such as `PREMISES_TYPETransit` and `TIME_OF_DAYAfternoon` show a notable shift in their posterior distributions compared to the priors, reflecting strong evidence provided by the data. Conversely, predictors with minimal shifts suggest weaker evidence or smaller effects on the model outcome.

```{r}
#| label: fig-post_dist
#| fig-cap: Posterior distribution for logistic regression model 
#| echo: false
#| warning: false
#| message: false
#| 

pp_check(violent_crime_model) +
  theme(legend.position = "bottom")
```

```{r}
#| label: fig-post_prior
#| fig-cap: Comparing the posterior with the prior 
#| echo: false
#| warning: false
#| message: false

#### Workspace setup ####
library(tidyverse)
library(rstanarm)
library(here)
library(arrow)

#### Read cleaned data ####
analysis_data <- read_parquet(here::here("data/02-analysis_data/cleaned_crime_data_for_model.parquet"))

# Ensure predictor variables are set as factors in the loaded data
analysis_data$PREMISES_TYPE <- factor(analysis_data$PREMISES_TYPE)
analysis_data$TIME_OF_DAY <- factor(analysis_data$TIME_OF_DAY)

# Sample 1000 observations for consistent model comparison (optional step)
set.seed(304)
crime_data_reduced <- 
  analysis_data |> 
  slice_sample(n = 1000)

# Load or fit the model if not already available
if (!exists("violent_crime_model")) {
  violent_crime_model <- readRDS(here::here("models/violent_crime_model.rds"))
}

# Generate the Posterior vs. Prior plot
posterior_vs_prior(violent_crime_model, size = 0.1) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    axis.text.x = element_text(hjust = 1, vjust = 0.5),
    text = element_text(size = 8)
  ) +
  guides(color = guide_legend(ncol = 4)) +
  coord_flip()

```


## Diagnostics {#sec-diagnostics}

### Markov Chain Monte Carlo Convergence Check

To assess the convergence of the Markov Chain Monte Carlo (MCMC) sampling for the Bayesian logistic regression model, trace plots and Rhat plots were analyzed. These diagnostics are to ensure that the chains mix well and converge to a stable distribution, providing reliable parameter estimates.

#### Trace Plots

@fig-trace-premise and @fig-trace-time display the trace plots for the model's intercept, premises type predictors, and time of day predictors. Each plot shows the sampled parameter values across iterations for all four chains.

- **Premises Type Predictors**: As seen in @fig-trace-premise, the chains for predictors like `House`, `Commercial`, `Educational`, and `Outside` fluctuate around stable mean values, indicating good mixing and convergence.
- **Time of Day Predictors**: @fig-trace-time illustrates the trace plots for `Morning`, `Afternoon`, and `Evening` time categories, along with `Transit Premises`. The chains for these predictors also show no significant trends or drift, confirming convergence.


```{r}
#| echo: false
#| message: false
#| warning: false
#| label: fig-trace-premise
#| fig-cap: "Trace plots of intercept and premises type predictors"
#| fig-subcap: ["Intercept", "House", "Commercial", "Educational", "Outside", "Other"]
#| layout-ncol: 2

plot(violent_crime_model, "trace", "(Intercept)")
plot(violent_crime_model, "trace", "PREMISES_TYPEHouse")
plot(violent_crime_model, "trace", "PREMISES_TYPECommercial")
plot(violent_crime_model, "trace", "PREMISES_TYPEEducational")
plot(violent_crime_model, "trace", "PREMISES_TYPEOutside")
plot(violent_crime_model, "trace", "PREMISES_TYPEOther")
```

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: fig-trace-time
#| fig-cap: "Trace plots of time of day predictors"
#| fig-subcap: ["Transit Premises", "Morning", "Afternoon", "Evening"]
#| layout-ncol: 2


plot(violent_crime_model, "trace", "PREMISES_TYPETransit")
plot(violent_crime_model, "trace", "TIME_OF_DAYMorning")
plot(violent_crime_model, "trace", "TIME_OF_DAYAfternoon")
plot(violent_crime_model, "trace", "TIME_OF_DAYEvening")
```

```{r}
#| echo: false
#| eval: true
#| message: false
#| warning: false
#| label: fig-rhat
#| fig-cap: "Rhat plot for MCMC convergence"

# Rhat plot to check MCMC convergence
plot(violent_crime_model, "rhat")

```

## 90% Credibility Interval {#sec-credibility-interval}

Figures @fig-modelresults1 and @fig-modelresults2 visualize the 90% credible intervals for the predictors in the Bayesian logistic regression model. These plots provide intuitions into the uncertainty surrounding the estimated coefficients for each predictor.

Figure @fig-modelresults1 displays the 90% credible intervals for all predictors without restrictions on the x-axis. This plot shows how the predictors such as `PREMISES_TYPE` and `TIME_OF_DAY` influence the likelihood of violent crimes. For example, `PREMISES_TYPETransit` has a high positive credible interval, indicating a significant increase in the likelihood of violent crime in transit areas. Conversely, `PREMISES_TYPECommercial` and `PREMISES_TYPEEducational` have negative credible intervals, indicating a lower likelihood of violent crimes in these premises types.

In Figure @fig-modelresults2, the x-axis has been restricted to a range of -5 to 5 to better visualize predictors with smaller intervals. This refined view helps highlight subtle but meaningful differences between categories like `TIME_OF_DAYAfternoon` and `TIME_OF_DAYEvening`, which show a noticeable increase in the likelihood of violent crimes compared to the reference category (`TIME_OF_DAYEarly Morning`).


```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: fig-modelresults1
#| fig-cap: "90% credible intervals for predictors of violent crime likelihood"

modelplot(violent_crime_model, conf_level = 0.90, size = 0.2) +
  labs(x = "90% credibility interval") +
  theme(axis.text.y = element_text(size = 6))
```

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: fig-modelresults2
#| fig-cap: "90% credible intervals for predictors of violent crime likelihood with restricted x-axis limits"

# Create the model plot
model_plot <- modelplot(violent_crime_model, conf_level = 0.90, size = 0.2)

# Modify the x-axis limits
model_plot + xlim(-5, 5) +  # Adjust the limits as needed
  labs(x = "90% Credibility Interval") +
  theme(axis.text.y = element_text(size = 6))

```


\newpage

# References


